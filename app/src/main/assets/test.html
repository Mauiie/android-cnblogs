<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>test</title>
    <link type="text/css" rel="stylesheet" href="css/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="css/shCoreDefault.css"/>
    <link rel="stylesheet" type="text/css" href="css/blog-common.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="css/rae.css">

    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/highlight.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/highlighter/shCore.js"></script>
    <script type="text/javascript" src="js/highlighter/shAutoloader.js"></script>
    <script src="js/blog-common.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js" type="text/javascript"></script>
    <script src="js/rae.js" type="text/javascript"></script>
    <script type="text/javascript">
		var width = 0;

    function path() {
            var args = arguments,
            result = [];
            for (var i = 0; i < args.length; i++)
                result.push(args[i].replace('$', 'js/highlighter/'));
            return result
        }

		$(document).ready(function(){
			load();
			  SyntaxHighlighter.autoloader.apply(null, path(
            'applescript            $shBrushAppleScript.js',
            'actionscript3 as3      $shBrushAS3.js',
            'bash shell properties  $shBrushBash.js',
            'coldfusion cf          $shBrushColdFusion.js',
            'cpp c                  $shBrushCpp.js',
            'c# c-sharp csharp      $shBrushCSharp.js',
            'css                    $shBrushCss.js',
            'delphi pascal          $shBrushDelphi.js',
            'diff patch pas         $shBrushDiff.js',
            'erl erlang             $shBrushErlang.js',
            'groovy                 $shBrushGroovy.js',
            'java                   $shBrushJava.js',
            'jfx javafx             $shBrushJavaFX.js',
            'js jscript javascript  $shBrushJScript.js',
            'perl pl                $shBrushPerl.js',
            'php                    $shBrushPhp.js',
            'text plain             $shBrushPlain.js',
            'py python              $shBrushPython.js',
            'ruby rails ror rb      $shBrushRuby.js',
            'sass scss              $shBrushSass.js',
            'scala                  $shBrushScala.js',
            'sql                    $shBrushSql.js',
            'vb vbnet               $shBrushVb.js',
            'xml xhtml xslt html    $shBrushXml.js'
        ));
        SyntaxHighlighter.all();
        markdown_highlight();
			width = $("body").width();

			$("table").each(function(key,val){
				setTable(val);
			});

		});

		// 加载图片
		function loadImage(){
			$("img").each(function(key,val){
				$(val).load(function(){
					$(this).addClass("img-thumbnail");
					setImageSize($(this));
					});
			});
		}

		// 设置图片大小，防止图像溢出
		function setImageSize(obj){
			var imgWidth = $(obj).width();
			var src = $(obj).attr("src");
			var filter = ["ExpandedBlockStart.gif","ContractedBlock.gif"];

			for(var i in filter){
			    var item = filter[i];
			    if(src.indexOf(item)>=0){
			        return;
			    }
			}

			if(imgWidth>=width)
			{
				$(obj).css("width","100%");
			}
		}

		function load(){

			if(typeof(app) =="object"){
			var blog = app.getBlog();
			if(blog!=""){
				blog = $.parseJSON(blog);
				$("#blog_title").text(blog.title);
				$("#blog_date").text(blog.postDate);
				$("#blog_content").append(blog.content);
			}
			}

			loadImage();
		}





    </script>
</head>
<body>
<div class="container-fluid">
    <div id="header">
        <h3 id="blog_title"></h3>
        <span id="blog_date"></span>
        <!--<a href="javascript:window.locatrefreshCategoryload()">刷新页面</a>-->
    </div>
    <div id="blog_content">
        <h1>前言</h1><p><font size="3">Visual Studio 2017已经发布了很久了。做为集成了Asp.Net Core 1.1的地表最强IDE工具，越来越受.NET系的开发人员追捧。</font></p><p><font size="3">随着Google Angular4的发布。我一直在想，怎么能够用这个地表最强IDE工具编写Angular4的Asp.Net Core项目。经过不懈的研究。终于的得到了一套很好的解决方案与大家分享。</font></p><blockquote><p><font size="3">文章转载请著名出处：<a title="http://www.cnblogs.com/smallprogram" href="http://www.cnblogs.com/smallprogram">http://www.cnblogs.com/smallprogram</a></font></p></blockquote><p><font size="3"></font></p><font size="3"><p><br></p><h1>我们的目的</h1><p>随着Web技术的快速发展，新的技术层出不穷，这使得Web程序的用户体验不断提升。最具代表性的就是SPA(Single Page Application)应用。</p><p>技术的快速发展也有弊端，那就是学习成本的不断提升。作为一名开发人员，你需要不断学习、提升自己的技术以适应这个技术快速发展的时代，以让自己不在这个技术快速发展的洪流中所淘汰。</p><p>当然，我们的老大Microsoft也是如此，借着Asp.Net Core的机会，发布了好几款集成目前流行的前端框架的Asp.Net Core的模板。文章后边我就具体描述以一下。</p><h1>你需要知道的东西</h1><h2>你需要明白的东西</h2><p><p><p><div class="wlWriterSmartContent" style="margin: 0px; padding: 0px; float: none; display: inline;">1. <a href="https://nodejs.org/en/">NodeJS</a>,这是一个基于Chrome V8 JavaScript引擎构建的JavaScript运行时的库，NPM就包含在NodeJS中，他具有强大的生态系统。</div><p><div class="wlWriterSmartContent" style="margin: 0px; padding: 0px; float: none; display: inline;">2. <a href="https://www.npmjs.com/">NPM</a>包管理器，是Node包生态系统的管理器。可以使用他安装Angular所有的包以及依赖包。</div><p><div class="wlWriterSmartContent" style="margin: 0px; padding: 0px; float: none; display: inline;">2. <a href="https://docs.microsoft.com/zh-cn/dotnet/core/tools/">DotNet CLI</a>，这是微软提供的命令行接口工具。用于开发跨平台.NET程序的工具链。如果你安装了VS2017,默认应该已经安装DotNetCLI工具。</div><p><div class="wlWriterSmartContent" style="margin: 0px; padding: 0px; float: none; display: inline;">3. <a href="https://cli.angular.io/">AngularCLI</a>，这是Angular官方发布的AngularCLI工具，可以使用他对Angular进行新建、编译、运行等操作。</div><p>4. <a href="https://docs.microsoft.com/en-us/aspnet/core/#asp-net-core-documentation">Asp.Net Core</a>，这是微软推出的跨平台Web应用程序。功能强大。官方文档非常完善。</p><p>5. <a href="https://www.typescriptlang.org/">TypeScript</a>，这是一种类型化的JavaScript，可以通过他编译生成Javascript，Angular就是基于TypeScript的。</p><p>6. <a href="https://github.com/aisuhua/restful-api-design-references">RESTful API</a>，这是一个很火热的Web应用程序API的设计理念。微软官网也写过一篇关于RESTful的文章，但实在太老了。于是用aisuhua的GitHub代替了</p><h2>你需要了解的东西</h2><p>1. 翻GFW，根据我国国情需要，GFW是“必须要有的”，这无可厚非。但是带来的问题就是开发人员的一手资料被屏蔽。所以你应该了解怎么翻GFW。</p><p>2. 国内NPM源，之后会细说。</p><p>3. <a href="https://doc.webpack-china.org/">WebPack</a>，这是一个现代化的JavaScript模块打包器。具体内容可以去官网了解</p><p><br></p><p>也许有一些没有接触过以上提到的这些工具或知识的童鞋可能会一脸懵逼，但是不用担心也不用着急，本文会用最浅显易懂的方式告诉你如何配置。</p><p><br></p><h1>微软SPA模板(不在本文讨论范围)</h1><p>先说说老大Microsoft的模板。</p><p>想要安装微软官方提供的模板，我们就需要用到dotnet CLI工具了。这套模板是由微软Steve Sanderson提出并研发的。关于史蒂夫·桑德森，从2010年到现在，在微软从事Web技术工作。并且最先加入到Asp.Net MVC3的技术团队。构建了一系列JavaScript库以及Azure的门户网站。我们所熟知的Knockout.js就是这个人主导开发的。可以说是绝对的.Net技术大牛。</p><p>附上一张他的照片，还有他的<a href="https://twitter.com/StevenSanderson">Twitter</a>。有玩Twitter的可以Follow他</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707162023581-1698013594.png"><img width="343" height="456" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707162024769-986993553.png" border="0"></a></p><p>回到正题，想要安装这个模板，你就需要使用DotNet CLI工具了。具体命令如下：</p><blockquote><pre>dotnet new --install Microsoft.AspNetCore.SpaTemplates::*</pre></blockquote><p>当你使用CMD或Powershell运行后会得到一下结果：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165442190-1414888143.png"><img width="743" height="414" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165451972-1482221361.png" border="0"></a></p><p>可以看到微软很给力，给我提供了好多模板。有Angular的，有Knockout的，有Aurelia的，有React的，有Vue的。可以说，非常全面。</p><p>可以使用如下DotNetCLI命令根据模板新建项目。</p><blockquote><p>dotnet new angular</p></blockquote><p>如果你了解dotnet CLI，你就会明白，这条命名的意义就是从当前目录使用MVC ASP.NET Core with Angular创建一个Asp.Net Core的项目。</p><p>新建成功后，使用如下命令还原.NET依赖包和Angular依赖包：</p><blockquote><p>dotnet restore</p><p>npm install</p></blockquote><p>完成之后你就可以运行程序，查看效果：</p><p><img alt="Generated Angular application homepage" src="https://msdnshared.blob.core.windows.net/media/2017/02/angular-app-home-1024x590.png"></p><p>你不妨可以试试看，期间你可能需要一个高速VPN，否则你在执行npm install命令时，可能会有很多Angular的包安装不上。</p><p>有人会说，为啥我们不直接用微软的模板反而要自己去构建Asp.Net Core+Angular的应用程序呢。</p><p>其实原因很简单，微软一如既往的作风就是高度集成高度封装。他所提供的这些模板中，集成Server-side prerendering(服务端渲染)，WebPack dev middleware，Hot Module Replacement(模块热插拔)等等技术。最后再加上Angular。</p><p>如果你对这些技术了解程度不够，很难做到高度扩展。例如添加新的npm包也会有可能引起一些莫名其妙的异常。所以，我们才要自己去构建集成Angular的Asp.Net Core的应用程序。</p><p>有兴趣的童鞋可以自己去尝试一下。</p><h1>让我们开始把</h1><h2>1.新建一个Asp.Net Core项目</h2><p>打开宇宙最强IDE，Visual Studio 2017，新建一个Asp.Net Core项目。并且取个名字，比如AspNetCoreWithAngular4：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165454487-1124870488.png"><img width="900" height="482" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165458784-1058975233.png" border="0"></a></p><p>之后我们创建一个空的Asp.Net Core 程序，我是用的版本是1.1</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165502722-13840802.png"><img width="641" height="418" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165506581-1487537134.png" border="0"></a></p><p><br></p><h2>2. 配置我们的Asp.Net Core</h2><p>这一步，我们需要配置一些Core的依赖包，并且设置Core在VS重构时MSBuild不去编译Typescript文件，因为我们要使用其他工具去编译Typescript文件。</p><p>直接打开csproj文件：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165511972-1279556888.png"><img width="595" height="469" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165515597-1285372559.png" border="0"></a></p><p>添加如下代码：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165521190-1936582974.png"><img width="760" height="338" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170706165524378-1084076142.png" border="0"></a></p><p>代码：</p><blockquote><pre>&lt;PackageReference Include="Microsoft.AspNetCore.Mvc" Version="1.1.3" /&gt;</pre><pre>&lt;PackageReference Include="Microsoft.AspNetCore.StaticFiles" Version="1.1.2" /&gt;</pre></blockquote><p>在我们的项目中，Microsoft.AspNetCore.Mvc包能够允许我们添加控制器并且构建WebAPI，而Microsoft.AspNetCore.StaticFiles包可以让我们配置提供静态目录访问的功能。例如默认提供/wwwroot目录的访问。</p><p>因为我们会使用其他工具去编译Typescript文件，所以需要在PropertyGroup节点中配置</p><blockquote><p><font face="Courier New" size="2">&lt;TypeScriptCompileBlocked&gt;true&lt;/TypeScriptCompileBlocked&gt;</font></p></blockquote><p><br></p><p>保存csproj文件后，VS2017会自动下载相关包。如果你在MacOS或者Linux环境，请使用dotnet restore命令还原包。</p><h2>3. 配置Startup.cs文件</h2><p>首先在ConfigServives方法中添加MVC服务：</p><blockquote><p>services.AddMvc();</p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005155487-775248141.png"><img width="822" height="222" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005204378-1156193945.png" border="0"></a></p><p>如果VS出现红色波浪线，你需要关闭项目，重新打开项目即可。</p><p>之后，删除Configure方法中的所有代码，使用如下代码替换：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005212940-1493521810.png"><img width="878" height="415" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005219894-412058949.png" border="0"></a></p><div class="cnblogs_code" style="padding: 5px; border: 1px solid rgb(204, 204, 204); border-image: none; background-color: rgb(245, 245, 245);"><pre>app.Use(<span style="color: rgb(0, 0, 255);">async</span> (context, next) =&gt;<span style="color: rgb(0, 0, 0);"> {
    </span><span style="color: rgb(0, 0, 255);">await</span><span style="color: rgb(0, 0, 0);"> next();
    </span><span style="color: rgb(0, 0, 255);">if</span> (context.Response.StatusCode == <span style="color: rgb(128, 0, 128);">404</span> &amp;&amp;
       !System.IO.Path.HasExtension(context.Request.Path.Value) &amp;&amp;
       !context.Request.Path.Value.StartsWith(<span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">/api/</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">))
    {
        context.Request.Path </span>= <span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">/index.html</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">;
        </span><span style="color: rgb(0, 0, 255);">await</span><span style="color: rgb(0, 0, 0);"> next();
    }
});

app.UseMvcWithDefaultRoute();

app.UseDefaultFiles();
app.UseStaticFiles();</span></pre></div><p>这里简单说一下，首先第一个app.Use中间件的作用是当系统返回404状态码并且访问的Request不包含文件扩展名并且访问Request不是以“/api/”开头的访问直接将其跳转到/index.html</p><p>app.UseMvcWithDefaultRoute()的意思是使用MVC的默认路由中间件。</p><p>app.UseDefaultFiles()的意思是启用默认文档提供器中间件，他会对只有主机的URL进行访问时搜索default.html、default.htm、index.html、index.htm文件，如果有就返回内容。</p><p>app.UseStaticFiles()的意思启用程序的静态文件支持，也就是启用wwwroot文件夹可以通过URL访问。</p><h2>4. 创建一个APIController</h2><p>在根目录中创建一个Controllers的文件夹，当然直接在根目录创建一个WebAPIController也可以。</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005222690-669311142.png"><img width="734" height="375" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005229159-1510806775.png" border="0"></a></p><p>这里简单说一下，VS2017 15.2(26430.14)这个版本有一个小bug，就是当你使用MVC脚手架功能的时候，比如上图的新建中的“控制器”，亦或者在Controller的Action中使用右键新建视图的功能时，中文会出现乱码。所以我推荐大家直接使用“新建项”，放弃使用脚手架功能。当然在目前的项目中涉及不到上述问题。</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005236737-1491326931.png"><img width="785" height="544" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005242315-133279337.png" border="0"></a></p><p>创建一个默认的ValuesController</p><p>让我们来修改一下ValuesController中Get方法的返回值：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005244347-1108686914.png"><img width="610" height="196" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005249987-1152738590.png" border="0"></a></p><div class="cnblogs_code" style="padding: 5px; border: 1px solid rgb(204, 204, 204); border-image: none; background-color: rgb(245, 245, 245);"><pre><span style="color: rgb(0, 0, 255);">public</span> IEnumerable&lt;<span style="color: rgb(0, 0, 255);">string</span>&gt;<span style="color: rgb(0, 0, 0);"> Get()
 {
     </span><span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 255);">new</span> <span style="color: rgb(0, 0, 255);">string</span>[] { <span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">Hello Angular4</span><span style="color: rgb(128, 0, 0);">"</span>, <span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">Hello Asp.Net Core 1.1</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"> };
 }</span></pre></div><h1>创建一个Angular4的应用程序</h1><p>我们的Asp.Net Core服务器已经构建完成了。现在让我们来向项目中添加Angular</p><h2>1. 在项目位置中打开CMD或PowerShell命令行工具</h2><p>以PowerShell为例，输如如下命令，导航到项目所在目录：</p><blockquote><p>PS C:\WINDOWS\system32&gt; cd F:\Code\TFSProject\GitHub\AspNetCoreWithAngular4\AspNetCoreWithAngular4\AspNetCoreWithAngular
        4</p></blockquote><p>我的这个路径有点长，当人如果你觉得麻烦，可以安装一个小插件。他可以直接从项目根目录打开命令行工具。插件的名字是：</p><p>Open Command Line，你可以通过Visual Studio Marketplace下载安装。安装好之后，你就可以通过如下方式直接在根目录打开命令行工具了：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005252237-660742612.png"><img width="673" height="542" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005258565-1800775308.png" border="0"></a></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005259597-911486679.png"><img width="776" height="165" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005301144-1281720062.png" border="0"></a></p><p>也许有人会问，为什么不用VS的PowerShell Interactive Window,我只想说我不喜欢他的界面。</p><h2>2. 全局安装AngularCLI</h2><blockquote><p>如果你的机器上没有安装nodeJS，你需要去官网下载nodeJS进行安装，根据你的系统下载相应的安装包。node会有两个版本可供下载。一个是LTS版本，也就是通常我们所说的稳定版，另一种是Current版本，就是尝鲜版。有新的功能。当然我推荐安装稳定版。</p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005304878-1903817058.png"><img width="729" height="409" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005306831-1130782519.png" border="0"></a></p><p>安装成功之后，我们需要处理的下一个问题就是GFW的问题。众所周知，node的资源镜像是在GFW禁止访问的黑名单URL列表中。这就导致你可能在使用node的NPM包管理器安装AngularCLI的过程出现问题。不过马云家的淘宝已经有了很好的解决方案，那就是国内NPM数据镜像。</p><p>提到国内NPM数据镜像，淘宝建立自己的NPM数据镜像，他们的数据镜像与NPM官网的数据镜像是同步的，时间差大约在10分左右。</p><p>因为是在国内，所以不会受到GFW的影响。我们需要做的就是更改NPM包管理器的镜像地址，在我们的刚刚的PowerShell中使用如下命令：</p><blockquote><p>npm config set registry <a href="https://registry.npm.taobao.org">https://registry.npm.taobao.org</a></p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005308112-843907428.png"><img width="782" height="147" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005309628-942113227.png" border="0"></a></p><p>当你替换之后，在不使用VPN或代理的情况下，通过NPM安装包就会速度很快了。</p><p>但是我要阐述一点，当我们安装AngularCLI的时候，其中有一个依赖项为node-sass，他的指定访问一个https://github.com/sass/node-sass/releases/download/v4.5.3/win32-x64-57_binding.node地址去下载，该地址是被GFW屏蔽的。所以就算我们使用国内NPM镜像，也会出现问题。</p><p>当然最好的解决方案是设置NPM为原始镜像地址，然以挂上高速VPN，去安装AngularCLI。</p><p>也许你本的网络很好，你也可以尝试使用淘宝NPM镜像，但是不要开VPN，那样会很慢。</p><p>就像我家和我单位的网。都是淘宝NPM镜像，单位安装AngularCLI一点问题没有，但是家里就出现了我上面说的node-sass下载不下来的问题了。</p><p><br></p><p>替换完淘宝NPM镜像之后，那么让我们继续，使用如下命令全局安装AngularCLI，注意这个只需要安装一次即可：</p><blockquote><p>npm install –g @angular/cli</p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005310565-1744793946.png"><img width="588" height="133" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005311456-1358019558.png" border="0"></a></p><blockquote><p>其中npm install是NPM安装的意思。</p><p>-g是全局安装的意思，是-global的简写</p><p>@angular/cli就是告诉NPM我们要安装AngularCLI</p></blockquote><p>执行后就是慢慢等待他完成吧。</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005315144-1341418012.png"><img width="879" height="124" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005318284-1507714322.png" border="0"></a></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005327815-1129490546.png"><img width="900" height="183" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005333315-1234680680.png" border="0"></a></p><p>如果安装失败，你需要执行一下命令，卸载AngularCLI：</p><blockquote><p>npm uninstall –g @angular/cli</p><p>npm cache clean --force</p></blockquote><p>并删除“C:\Users\[你用系统账户名]\AppData\Roaming\npm\node_modules”目录下的@angular文件夹，重复上面的安装步骤。</p><p>安装成功之后你会看到如下界面：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005421659-936249704.png"><img width="900" height="574" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707005426331-1001762619.png" border="0"></a></p><p>OK，通过上述操作，我们已经在系统上安装完成了AngularCLI。</p><h2>3. 在Asp.NET Core 中安装Angular</h2><p>现在回到之前的项目路径：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134815737-979672125.png"><img width="900" height="135" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134823065-910271660.png" border="0"></a></p><p>运行如下命令，在项目根目录中新建一个Angular项目：</p><blockquote><p>ng new [你的Angular项目名称] --skip-install</p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134825456-40646433.png"><img width="900" height="94" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134827394-1143385051.png" border="0"></a></p><p>解析一下这条命令：</p><blockquote><p>ng new是AngularCLI的新建命令</p><p>--skip-install是npm的跳过还原包命令</p><p>作用就是在当前目录下新建一个Angular项目并且跳过还原包</p></blockquote><p><font size="2">大神别嫌我啰嗦。我要照顾一下新手。</font></p><p>OK，运行之后的结果：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134828472-321712009.png"><img width="896" height="558" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134838878-1997401716.png" border="0"></a></p><h2>4. 目录调整</h2><p>回到VS，你会发现，目录中多了一个Angular的目录：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134842081-30819089.png"><img width="440" height="447" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707134854612-956196863.png" border="0"></a></p><p>这就是刚刚我们使用AngularCLI安装后的文件。</p><p>让我们调整一下目录结构，已使Angular能更好的集成到Core中：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140135847-1978767884.png"><img width="446" height="493" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140142800-1843122305.png" border="0"></a></p><p>将Angular文件夹下的所有文件拖拽到系统根目录下。并且删除Angular文件夹。调整后的结果：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140147690-270257089.png"><img width="499" height="497" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140152222-1574157808.png" border="0"></a></p><p>啰嗦几句，其中package.json是Angular的所有包文件，你可以打开看一下，其中包含许多除了Angular包以外的依赖包。</p><p>如果你想了解这些文件都是干嘛的，作用是什么，请参考Angular官网</p><p>之后我们需要把src文件夹重命名一下，当然也可以不重命名，为了看着方便，我把他重命名为ClientApp。</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140154503-594146240.png"><img width="541" height="555" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140158784-972143891.png" border="0"></a></p><h2>5. 启用Angular的HTTP模式和表单绑定模式</h2><p>打开ClientApp/app/app.module.ts文件，加入FormsModule和HttpModule并且在NgMudule导入</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140200909-1553006405.png"><img width="601" height="429" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707140205487-929117459.png" border="0"></a></p><p>这里插一句，由于我们在安装Angular时使用了--skip-install，所以这里会提示我们@angular组件找不到，不过没关系，我们会在之后还原Angular的相关包</p><div class="cnblogs_code" style="padding: 5px; border: 1px solid rgb(204, 204, 204); border-image: none; background-color: rgb(245, 245, 245);"><pre>import { BrowserModule } <span style="color: rgb(0, 0, 255);">from</span> <span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">@angular/platform-browser</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">;
import { NgModule } </span><span style="color: rgb(0, 0, 255);">from</span> <span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">@angular/core</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">;

import { FormsModule } </span><span style="color: rgb(0, 0, 255);">from</span> <span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">@angular/forms</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">;
import { HttpModule } </span><span style="color: rgb(0, 0, 255);">from</span> <span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">@angular/http</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">;

import { AppComponent } </span><span style="color: rgb(0, 0, 255);">from</span> <span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">./app.component</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">;

@NgModule({
   declarations: [
     AppComponent
   ],
   imports: [
       BrowserModule,
       FormsModule,
       HttpModule
   ],
   providers: [],
   bootstrap: [AppComponent]
})
export </span><span style="color: rgb(0, 0, 255);">class</span> AppModule { }</pre></div><h2>6. 配置.angular-cli.json，tsconfig.json，tsconfig.app.json，tsconfig.spec.json</h2><p>由于我们使用的是Asp.Net Core集成Angular，所以我们需要告诉Angular将程序输出到wwwroot文件夹。当使用AngularCLI编译Angular时，Angular将会把编译后的文件输出到Asp.Net Core的静态文件目录wwwroot下。</p><p>配置如下</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153829284-375859849.png"><img width="710" height="445" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153830128-8799625.png" border="0"></a></p><p>同样的配置tsconfig.json，tsconfig.app.json，tsconfig.spec.json，tsconfig.json文件是编译TypeScript文件的配置文件。同样需要修改输出位置：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153833331-1708695354.png"><img width="676" height="399" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153835237-1273702722.png" border="0"></a></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153836409-1618873381.png"><img width="795" height="383" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153837565-1199398874.png" border="0"></a></p><h2>7. 从Angular中调用Asp.Net Core WebApi</h2><p>这里我们需要修改app.component.ts文件。</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153838222-2014274179.png"><img width="398" height="168" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153838909-684780686.png" border="0"></a></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153839440-1341965861.png"><img width="748" height="416" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153840440-783822845.png" border="0"></a></p><div class="cnblogs_code" style="padding: 5px; border: 1px solid rgb(204, 204, 204); border-image: none; background-color: rgb(245, 245, 245);"><pre>import { Component, OnInit } <span style="color: rgb(0, 0, 255);">from</span> <span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">@angular/core</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">;
import { Http } </span><span style="color: rgb(0, 0, 255);">from</span> <span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">@angular/http</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">
@Component({
    selector: </span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">app-root</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">,
    templateUrl: </span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">./app.component.html</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">,
    styleUrls: [</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">./app.component.css</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">]
})
export </span><span style="color: rgb(0, 0, 255);">class</span><span style="color: rgb(0, 0, 0);"> AppComponent implements OnInit {
    constructor(</span><span style="color: rgb(0, 0, 255);">private</span><span style="color: rgb(0, 0, 0);"> _httpService: Http) { }
    apiValues: </span><span style="color: rgb(0, 0, 255);">string</span>[] =<span style="color: rgb(0, 0, 0);"> [];
    ngOnInit() {
        </span><span style="color: rgb(0, 0, 255);">this</span>._httpService.<span style="color: rgb(0, 0, 255);">get</span>(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">/api/values</span><span style="color: rgb(128, 0, 0);">'</span>).subscribe(values =&gt;<span style="color: rgb(0, 0, 0);"> {
            </span><span style="color: rgb(0, 0, 255);">this</span>.apiValues = values.json() <span style="color: rgb(0, 0, 255);">as</span> <span style="color: rgb(0, 0, 255);">string</span><span style="color: rgb(0, 0, 0);">[];
        });
    }
}</span></pre></div><p>当Angular在Core上运行之后，他会向ValuesController发出GET请求，并且返回一个字符串数组。</p><p>之后我们需要修改ClientApp/app/app.component.html文件，然他来显示WebApi返回的数据：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153841065-715966625.png"><img width="734" height="241" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153841690-629741683.png" border="0"></a></p><div class="cnblogs_code" style="padding: 5px; border: 1px solid rgb(204, 204, 204); border-image: none; background-color: rgb(245, 245, 245);"><pre><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">div </span><span style="color: rgb(255, 0, 0);">style</span><span style="color: rgb(0, 0, 255);">="text-align:center"</span><span style="color: rgb(0, 0, 255);">&gt;</span>
  <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">h1</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
    这是一个Asp.Net Core 1.1 With Angular4应用程序
  </span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">h1</span><span style="color: rgb(0, 0, 255);">&gt;</span>
  <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">h2</span><span style="color: rgb(0, 0, 255);">&gt;</span>下面的信息是由Asp.Net Core WebAPI返回的<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">h2</span><span style="color: rgb(0, 0, 255);">&gt;</span>
  <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">ul </span><span style="color: rgb(255, 0, 0);">*ngFor</span><span style="color: rgb(0, 0, 255);">="let value of apiValues"</span><span style="color: rgb(0, 0, 255);">&gt;</span>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">li</span><span style="color: rgb(0, 0, 255);">&gt;</span>{{value}}<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">li</span><span style="color: rgb(0, 0, 255);">&gt;</span>
  <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">ul</span><span style="color: rgb(0, 0, 255);">&gt;</span>
  <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">img </span><span style="color: rgb(255, 0, 0);">width</span><span style="color: rgb(0, 0, 255);">="300"</span><span style="color: rgb(255, 0, 0);"> src</span><span style="color: rgb(0, 0, 255);">="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCAyNTAgMjUwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNTAgMjUwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDojREQwMDMxO30NCgkuc3Qxe2ZpbGw6I0MzMDAyRjt9DQoJLnN0MntmaWxsOiNGRkZGRkY7fQ0KPC9zdHlsZT4NCjxnPg0KCTxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMTI1LDMwIDEyNSwzMCAxMjUsMzAgMzEuOSw2My4yIDQ2LjEsMTg2LjMgMTI1LDIzMCAxMjUsMjMwIDEyNSwyMzAgMjAzLjksMTg2LjMgMjE4LjEsNjMuMiAJIi8+DQoJPHBvbHlnb24gY2xhc3M9InN0MSIgcG9pbnRzPSIxMjUsMzAgMTI1LDUyLjIgMTI1LDUyLjEgMTI1LDE1My40IDEyNSwxNTMuNCAxMjUsMjMwIDEyNSwyMzAgMjAzLjksMTg2LjMgMjE4LjEsNjMuMiAxMjUsMzAgCSIvPg0KCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0xMjUsNTIuMUw2Ni44LDE4Mi42aDBoMjEuN2gwbDExLjctMjkuMmg0OS40bDExLjcsMjkuMmgwaDIxLjdoMEwxMjUsNTIuMUwxMjUsNTIuMUwxMjUsNTIuMUwxMjUsNTIuMQ0KCQlMMTI1LDUyLjF6IE0xNDIsMTM1LjRIMTA4bDE3LTQwLjlMMTQyLDEzNS40eiIvPg0KPC9nPg0KPC9zdmc+DQo="</span><span style="color: rgb(0, 0, 255);">&gt;</span>
<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">div</span><span style="color: rgb(0, 0, 255);">&gt;</span></pre></div><p>其中 *ngFor循环遍历apiValues并一个一个的输出到value中。这是Angular的一种语法。更多语法你需要参阅Angular官方文档。</p><p><br></p><h2>8. 安装Angular所有依赖项</h2><p>这一步我们就要用到node了。就是安装AngularCLI一样。使用NPM包管理器。</p><p>首先开启Powershell或CMD命令提示行工具，将路径设置到项目根目录。执行如下命令：</p><blockquote><p>npm install</p></blockquote><p>执行该命令后，npm会根据项目中的package.json配置文件安装包括Angular在内的所有依赖包：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153842331-1377198081.png"><img width="773" height="87" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153842847-1228919670.png" border="0"></a></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153843269-767444657.png"><img width="782" height="111" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153843925-984721771.png" border="0"></a></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153844440-2043554886.png"><img width="795" height="518" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153845331-1263057999.png" border="0"></a></p><p>当出现如上图所示界面，没有ERR，表示Angular包安装成功了。其中会有两个警告，不必在乎。这是正常的。</p><p>回到VS，显示全部文件，你会发现多出一个node_module的文件夹，并且依赖项中会出现npm依赖，这个文件夹里包含的就是包括Angular在内的所有依赖包。不要把他包含在项目中。否则会出错。</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153846097-1942212078.png"><img width="368" height="498" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153846753-1467377624.png" border="0"></a></p><p><br></p><h1>编译并运行程序</h1><h2>1. 编译Angular程序</h2><p>执行AngularCLI命令编译Angular程序，同样需要使用PowerShell或CMD命令行工具，将路径设置为项目根目录，执行如下名：</p><blockquote><p>ng build</p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153847284-1564603094.png"><img width="900" height="105" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153848034-128818385.png" border="0"></a></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153848769-1094715765.png"><img width="900" height="191" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153849503-709754584.png" border="0"></a></p><p>编译成功之后，会显示如上图所示的内容</p><p>回到VS中你会发现wwwroot文件夹下出现了编译好的JS文件和HTML文件等。不要在意wwwroot文件夹的图标从一个小地球变成了文件图标。：-）</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153850097-1108843884.png"><img width="345" height="570" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153850628-777412587.png" border="0"></a></p><h2>2. 编译运行Asp.Net Core应用程序</h2><p>之后使用DotNetCLI编译并运行Asp.NET Core应用程序，执行如下命令：</p><blockquote><p>dotnet run</p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153851237-1312443669.png"><img width="739" height="240" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153852019-1230999439.png" border="0"></a></p><h2>3. 打开浏览器运行</h2><p>打开浏览器，运行http://localhost:5000，得到如下结果：</p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153852675-1941860578.png"><img width="876" height="552" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153853612-1497426952.png" border="0"></a></p><p><br></p><p><br></p><h1>提升开发的友好度</h1><p>也许有的朋友可能会说。太麻烦了。</p><p>是的。确实是有点麻烦，因为我们必须同时完成两条线路上的编译工作。</p><p>一条线路是Angular的编译工作。</p><p>另一条线路是Asp.Net Core的编译工作。</p><p>如果我们能够在Angular和Asp.Net Core的代码被更改时，系统自动编译他们，那就太好了。 </p><p>这里我给出我的解决方案。如果有大神有更好的解决方案，可以留言或联系我。在此谢过~</p><h2>1. 将API调用代理到Asp.Net Core服务上</h2></font><p><font size="3">在开发的过程中，我们会用到AngularCLI命令中的 <font style="background-color: rgb(204, 204, 204);">ng serve </font>命令来启用Angular的监控服务模式。他会监控Angular的源码变化，当源码被改变时，自动重新编译Angular程序并编译TypeScript代码。默认情况下ng serve提供的是localhost:4200地址。</font></p><p><font size="3">并且Angular默认接受Request的地址为localhost:4200/api，这与我们Asp.Net Core默认的localhost:5000不一样。</font></p><p><font size="3">所以我们要通过配置proxy来解决这个问题。</font></p><p><font size="3">首先在项目根目录中添加一个json文件，取名字叫proxy.config.json</font></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153854925-1751922186.png"><img width="412" height="477" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153855831-1092781561.png" border="0"></a></p><p><font size="3">为这个文件添加如下配置代码</font></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153856472-568368908.png"><img width="418" height="175" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707153857034-983593408.png" border="0"></a></p><div class="cnblogs_code" style="padding: 5px; border: 1px solid rgb(204, 204, 204); border-image: none; background-color: rgb(245, 245, 245);"><pre><span style="color: rgb(0, 0, 0);">{
  </span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">/api</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">: {
    </span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">target</span><span style="color: rgb(128, 0, 0);">"</span>: <span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">http://localhost:5000</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,
    </span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">secure</span><span style="color: rgb(128, 0, 0);">"</span>: <span style="color: rgb(0, 0, 255);">false</span><span style="color: rgb(0, 0, 0);">
  }
}</span></pre></div><h2>2. 启用Asp.Net Core自动编译</h2><p><font size="3">如果Angular能够自动进行更改重编译运行，并且Asp.Net Core也能用监控更改自动重编译，那绝对是我想要的。</font></p><p><font size="3">启用Asp.Net Core自动重编译，需要修改.csproj文件，添加一个DotNetCLI工具包。代码如下：</font></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160540175-1151735471.png"><img width="827" height="426" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160541862-565726962.png" border="0"></a></p><div class="cnblogs_code" style="padding: 5px; border: 1px solid rgb(204, 204, 204); border-image: none; background-color: rgb(245, 245, 245);"><pre><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">ItemGroup</span><span style="color: rgb(0, 0, 255);">&gt;</span>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">DotNetCliToolReference </span><span style="color: rgb(255, 0, 0);">Include</span><span style="color: rgb(0, 0, 255);">="Microsoft.DotNet.Watcher.Tools"</span><span style="color: rgb(255, 0, 0);"> Version</span><span style="color: rgb(0, 0, 255);">="1.0.1"</span> <span style="color: rgb(0, 0, 255);">/&gt;</span>
<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">ItemGroup</span><span style="color: rgb(0, 0, 255);">&gt;</span></pre></div><p><font size="3">保存文件后，VS会自动还原安装这个包。如果没有自动还原，请使用DotNetCLI命名还原包：</font></p><blockquote><p><font size="3">dotnet restore</font></p></blockquote><h2>3. 以监控模式同时运行Angular和Asp.Net Core</h2><p><font size="3">使用PowerShell或CMD命令行工具，运行如下命令以监控模式启用Asp.Net Core服务器</font></p><blockquote><p><font size="3">dotnet watch run</font></p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160543269-974298940.png"><img width="751" height="166" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160545690-1820315672.png" border="0"></a></p><p><font size="3">打开另一个PowerShell或CMD命令行工具，以监控模式配置文件运行Angular</font></p><blockquote><p><font size="3">ng serve --proxy-config proxy.config.json</font></p></blockquote><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160547565-378878091.png"><img width="782" height="208" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160548987-866268883.png" border="0"></a></p><p><font size="3">现在让我们打开浏览器，访问</font><font size="3"><a href="http://localhost:4200">http://localhost:4200</a></font></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160550378-1996829492.png"><img width="742" height="468" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160551128-1335724659.png" border="0"></a></p><p><font size="3">打开ValuesContoller，让我们更改一些东西：</font></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160551737-470391167.png"><img width="698" height="391" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160552878-1395967585.png" border="0"></a></p><p><font size="3">打开ClientApp/app/app.component.html文件，更改一些东西：</font></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160553581-1959537973.png"><img width="721" height="273" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160554128-1881721159.png" border="0"></a></p><p><font size="3">保存上面两步的更改后，回到浏览器，你会惊奇的发现，Asp.Net Core和Angular的代码变更已经生效了</font></p><p><a href="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160554784-1061263127.png"><img width="793" height="500" title="image" style="display: inline; background-image: none;" alt="image" src="http://images2015.cnblogs.com/blog/680658/201707/680658-20170707160555565-1274119747.png" border="0"></a></p><p><br></p><p><strong><font size="3">OK ,至此，使用在Visual Studio 2017中使用Asp.Net Core构建Angular4应用程序撰写完毕。</font></strong></p><p><strong><font size="3">希望本文对你有所帮助</font></strong></p><blockquote><p><strong><font size="3">转载请著名出处：<a href="http://www.cnblogs.com/smallprogram">http://www.cnblogs.com/smallprogram</a></font></strong></p></blockquote><p><font size="3">如果有哪位大神知道更好的并行运行解决方案，请为我留言或联系我，再次先行谢过~</font></p><p><font size="3">最后附上本项目的源码：　<a title="https://github.com/smallprogram/AspNetCoreWithAngular4" href="https://github.com/smallprogram/AspNetCoreWithAngular4">https://github.com/smallprogram/AspNetCoreWithAngular4</a>　，需要手工还原NPM哦～</font></p><p><font size="3">请求博客园的超管给加个精~</font></p>
    </div>
</div>
</body>
</html>